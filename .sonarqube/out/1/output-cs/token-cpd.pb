Ÿ
dC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Validators\ResourceDTOValidator.cs
	namespace 	
BusinessLogic
 
. 

Validators "
{ 
public 

class  
ResourceDTOValidator %
:& '
AbstractValidator( 9
<9 :
ResourceCreateDTO: K
>K L
{ 
public  
ResourceDTOValidator #
(# $
)$ %
{		 	
RuleFor

 
(

 
x

 
=>

 
x

 
.

 
Name

 
)

  
. 
NotEmpty 
( 
) 
. 
WithMessage &
(& '
$str' :
): ;
. 
MaximumLength 
( 
$num !
)! "
." #
WithMessage# .
(. /
$str/ S
)S T
;T U
RuleFor 
( 
x 
=> 
x 
. 
Description &
)& '
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( B
)B C
. 
MaximumLength 
( 
$num "
)" #
.# $
WithMessage$ /
(/ 0
$str0 [
)[ \
;\ ]
RuleFor 
( 
x 
=> 
x 
. 
PricePerHour '
)' (
. 
GreaterThan 
( 
$num 
) 
.  
WithMessage  +
(+ ,
$str, T
)T U
;U V
RuleFor 
( 
x 
=> 
x 
. 

CategoryId %
)% &
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( A
)A B
;B C
} 	
} 
} ˘
dC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Validators\CategoryDTOValidator.cs
	namespace 	
BusinessLogic
 
. 

Validators "
{ 
public 

class  
CategoryDTOValidator %
:& '
AbstractValidator( 9
<9 :
CategoryCreateDTO: K
>K L
{ 
public  
CategoryDTOValidator #
(# $
)$ %
{		 	
RuleFor

 
(

 
x

 
=>

 
x

 
.

 
Name

 
)

  
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( D
)D E
. 
MaximumLength 
( 
$num "
)" #
.# $
WithMessage$ /
(/ 0
$str0 ]
)] ^
;^ _
} 	
} 
} ºa
ZC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Services\UserServices.cs
	namespace

 	
BusinessLogic


 
.

 
Services

  
{ 
public 

class 
UserServices 
: 
IUserServices  -
{ 
private 
readonly 
IMapper  
mapper! '
;' (
private 
readonly 
IJwtService $

jwtService% /
;/ 0
private 
readonly 
UserManager $
<$ %
User% )
>) *
userManager+ 6
;6 7
private 
readonly '
ReservationServiceDbContext 4
ctx5 8
;8 9
private 
readonly 
SignInManager &
<& '
User' +
>+ ,
signInManager- :
;: ;
public 
UserServices 
( 
UserManager '
<' (
User( ,
>, -
userManager. 9
,9 :
IMapper; B
mapperC I
,I J'
ReservationServiceDbContextK f
ctxg j
,j k
SignInManagerl y
<y z
Userz ~
>~ 
signInManager
Ä ç
,
ç é
IJwtService
è ö

jwtService
õ •
)
• ¶
{ 	
this 
. 
userManager 
= 
userManager *
;* +
this 
. 
mapper 
= 
mapper  
;  !
this 
. 
ctx 
= 
ctx 
; 
this 
. 
signInManager 
=  
signInManager! .
;. /
this 
. 

jwtService 
= 

jwtService (
;( )
} 	
public 
async 
Task 
< 
LoginResponse '
>' (
Refresh) 0
(0 1
RefreshRequest1 ?
model@ E
,E F
stringG M
?M N
	ipAddressO X
)X Y
{ 	
var 
user 
= 
await 
userManager (
.( )
Users) .
.. / 
SingleOrDefaultAsync/ C
(C D
uD E
=>F H
uI J
.J K
RefreshTokensK X
.X Y
AnyY \
(\ ]
t] ^
=>_ a
tb c
.c d
Tokend i
==j l
modelm r
.r s
RefreshTokens 
)	 Ä
)
Ä Å
;
Å Ç
if 
( 
user 
== 
null 
) 
throw   
new   
HttpException   '
(  ' (
$str  ( 6
,  6 7
HttpStatusCode  8 F
.  F G
NotFound  G O
)  O P
;  P Q
var"" 
token"" 
="" 
await"" 
ctx"" !
.""! "
RefreshTokens""" /
.""/ 0
SingleAsync""0 ;
(""; <
x""< =
=>""> @
x""A B
.""B C
Token""C H
==""I K
model""L Q
.""Q R
RefreshToken""R ^
)""^ _
;""_ `
if$$ 
($$ 
!$$ 
token$$ 
.$$ 
IsActive$$ 
)$$ 
throw%% 
new%% 
HttpException%% '
(%%' (
$str%%( ?
,%%? @
HttpStatusCode%%A O
.%%O P
Unauthorized%%P \
)%%\ ]
;%%] ^
token'' 
.'' 
Revoked'' 
='' 
DateTime'' $
.''$ %
UtcNow''% +
;''+ ,
token(( 
.(( 
RevokedByIp(( 
=(( 
	ipAddress((  )
;(() *
var** 
newJwt** 
=** 

jwtService** #
.**# $
GenerateToken**$ 1
(**1 2

jwtService**2 <
.**< =
	GetClaims**= F
(**F G
user**G K
)**K L
)**L M
;**M N
var++ 
newRefreshJwt++ 
=++ 

jwtService++  *
.++* + 
GenerateRefreshToken+++ ?
(++? @
	ipAddress++@ I
??++J L
$str++M U
)++U V
;++V W
user-- 
.-- 
RefreshTokens-- 
.-- 
Add-- "
(--" #
newRefreshJwt--# 0
)--0 1
;--1 2
await// 
ctx// 
.// 
SaveChangesAsync// &
(//& '
)//' (
;//( )
return11 
new11 
LoginResponse11 $
{22 
AccessToken33 
=33 
newJwt33 $
,33$ %
RefreshToken44 
=44 
newRefreshJwt44 ,
.44, -
Token44- 2
}55 
;55 
}66 	
public77 
async77 
Task77 
<77 
LoginResponse77 '
>77' (
Login77) .
(77. /
UserLoginModel77/ =
model77> C
,77C D
string77E K
?77K L
	ipAddress77M V
)77V W
{88 	
var99 
user99 
=99 
await99 
userManager99 (
.99( )
FindByNameAsync99) 8
(998 9
model999 >
.99> ?
Login99? D
)99D E
;99E F
if;; 
(;; 
user;; 
==;; 
null;; 
||;; 
!;;  !
await;;! &
userManager;;' 2
.;;2 3
CheckPasswordAsync;;3 E
(;;E F
user;;F J
,;;J K
model;;L Q
.;;Q R
Password;;R Z
);;Z [
);;[ \
throw<< 
new<< 
HttpException<< '
(<<' (
$str<<( B
,<<B C
HttpStatusCode<<D R
.<<R S

BadRequest<<S ]
)<<] ^
;<<^ _
var>> 
refreshToken>> 
=>> 

jwtService>> )
.>>) * 
GenerateRefreshToken>>* >
(>>> ?
	ipAddress>>? H
??>>I K
$str>>L U
)>>U V
;>>V W
user?? 
.?? 
RefreshTokens?? 
.?? 
Add?? "
(??" #
refreshToken??# /
)??/ 0
;??0 1
awaitBB 
ctxBB 
.BB 
SaveChangesAsyncBB &
(BB& '
)BB' (
;BB( )
returnDD 
newDD 
(DD 
)DD 
{EE 
AccessTokenFF 
=FF 

jwtServiceFF (
.FF( )
GenerateTokenFF) 6
(FF6 7

jwtServiceFF7 A
.FFA B
	GetClaimsFFB K
(FFK L
userFFL P
)FFP Q
)FFQ R
,FFR S
RefreshTokenGG 
=GG 
refreshTokenGG +
.GG+ ,
TokenGG, 1
}HH 
;HH 
}II 	
publicKK 
asyncKK 
TaskKK 
LogoutKK  
(KK  !
)KK! "
{LL 	
awaitMM 
signInManagerMM 
.MM  
SignOutAsyncMM  ,
(MM, -
)MM- .
;MM. /
}NN 	
publicPP 
asyncPP 
TaskPP 
RegisterPP "
(PP" #
UserRegisterModelPP# 4
modelPP5 :
)PP: ;
{QQ 	
varRR 
userRR 
=RR 
mapperRR 
.RR 
MapRR !
<RR! "
UserRR" &
>RR& '
(RR' (
modelRR( -
)RR- .
;RR. /
varTT 
resTT 
=TT 
awaitTT 
userManagerTT '
.TT' (
CreateAsyncTT( 3
(TT3 4
userTT4 8
,TT8 9
modelTT: ?
.TT? @
PasswordTT@ H
)TTH I
;TTI J
ifVV 
(VV 
!VV 
resVV 
.VV 
	SucceededVV 
)VV 
throwWW 
newWW 
HttpExceptionWW '
(WW' (
resWW( +
.WW+ ,
ErrorsWW, 2
?WW2 3
.WW3 4
FirstOrDefaultWW4 B
(WWB C
)WWC D
?WWD E
.WWE F
DescriptionWWF Q
??WWR T
$strWWU \
,WW\ ]
HttpStatusCodeWW^ l
.WWl m

BadRequestWWm w
)WWw x
;WWx y
}XX 	
publicYY 
asyncYY 
TaskYY 
<YY 
ListYY 
<YY 
UserGetModelYY +
>YY+ ,
>YY, -
GetAllYY. 4
(YY4 5
)YY5 6
{ZZ 	
var[[ 
users[[ 
=[[ 
await[[ 
ctx[[ !
.[[! "
Users[[" '
.[[' (
ToListAsync[[( 3
([[3 4
)[[4 5
;[[5 6
return\\ 
mapper\\ 
.\\ 
Map\\ 
<\\ 
List\\ "
<\\" #
UserGetModel\\# /
>\\/ 0
>\\0 1
(\\1 2
users\\2 7
)\\7 8
;\\8 9
}]] 	
public^^ 
async^^ 
Task^^ 
<^^ 
string^^  
>^^  !
ForgetPssword^^" /
(^^/ 0
string^^0 6
Email^^7 <
)^^< =
{__ 	
var`` 
user`` 
=`` 
await`` 
userManager`` (
.``( )
FindByEmailAsync``) 9
(``9 :
Email``: ?
)``? @
;``@ A
ifbb 
(bb 
userbb 
==bb 
nullbb 
)bb 
throwcc 
newcc 
HttpExceptioncc '
(cc' (
$strcc( K
,ccK L
HttpStatusCodeccM [
.cc[ \

BadRequestcc\ f
)ccf g
;ccg h
varee 
tokenee 
=ee 
awaitee 
userManageree )
.ee) *+
GeneratePasswordResetTokenAsyncee* I
(eeI J
usereeJ N
)eeN O
;eeO P
returngg 
tokengg 
;gg 
}hh 	
publicii 
asyncii 
Taskii 
ResetPasswordii '
(ii' (
stringii( .
emailii/ 4
,ii4 5
stringii6 <
tokenii= B
,iiB C
stringiiD J
newPasswordiiK V
)iiV W
{jj 	
varkk 
userkk 
=kk 
awaitkk 
userManagerkk (
.kk( )
FindByEmailAsynckk) 9
(kk9 :
emailkk: ?
)kk? @
;kk@ A
ifll 
(ll 
userll 
==ll 
nullll 
)ll 
throwmm 
newmm 
HttpExceptionmm '
(mm' (
$strmm( K
,mmK L
HttpStatusCodemmM [
.mm[ \

BadRequestmm\ f
)mmf g
;mmg h
awaitoo 
userManageroo 
.oo 
ResetPasswordAsyncoo 0
(oo0 1
useroo1 5
,oo5 6
tokenoo7 <
,oo< =
newPasswordoo> I
)ooI J
;ooJ K
}pp 	
publicqq 
asyncqq 
Taskqq 
Deleteqq  
(qq  !
stringqq! '
idqq( *
)qq* +
{rr 	
varss 
userss 
=ss 
awaitss 
ctxss  
.ss  !
Usersss! &
.ss& '
FirstOrDefaultAsyncss' :
(ss: ;
xss; <
=>ss= ?
xss@ A
.ssA B
IdssB D
==ssE G
idssH J
)ssJ K
;ssK L
ifuu 
(uu 
useruu 
==uu 
nulluu 
)uu 
throwvv 
newvv 
HttpExceptionvv '
(vv' (
$strvv( A
,vvA B
HttpStatusCodevvC Q
.vvQ R
NotFoundvvR Z
)vvZ [
;vv[ \
awaitxx 
userManagerxx 
.xx 
DeleteAsyncxx )
(xx) *
userxx* .
)xx. /
;xx/ 0
}zz 	
}{{ 
}|| ÌÆ
^C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Services\ResourcesService.cs
	namespace 	
BusinessLogic
 
. 
Services  
{ 
public 

class 
ResourcesService !
:" #
IResourcesService$ 5
{ 
private 
readonly '
ReservationServiceDbContext 4
ctx5 8
;8 9
private 
readonly 
IMapper  
mapper! '
;' (
private 
readonly 
IRepository $
<$ %
Resource% -
>- .
repo/ 3
;3 4
public 
ResourcesService 
(  '
ReservationServiceDbContext  ;
ctx< ?
,? @
IMapperA H
mapperI O
,O P
IRepositoryQ \
<\ ]
Resource] e
>e f
repog k
)k l
{ 	
this 
. 
repo 
= 
repo 
; 
this 
. 
ctx 
= 
ctx 
; 
this 
. 
mapper 
= 
mapper  
;  !
} 	
public 
async 
Task 
< 
ResourceGetDTO (
>( )
Create* 0
(0 1
ResourceCreateDTO1 B
modelC H
)H I
{ 	
var 
entity 
= 
mapper 
.  
Map  #
<# $
Resource$ ,
>, -
(- .
model. 3
)3 4
;4 5
var 
category 
= 
await  
ctx! $
.$ %

Categories% /
.  $ %
Where  % *
(  * +
c  + ,
=>  - /
c  0 1
.  1 2
Id  2 4
==  5 7
model  8 =
.  = >

CategoryId  > H
)  H I
.!!$ %
Select!!% +
(!!+ ,
c!!, -
=>!!. 0
c!!1 2
.!!2 3
Slug!!3 7
)!!7 8
.""$ %
FirstOrDefaultAsync""% 8
(""8 9
)""9 :
;"": ;
if$$ 
($$ 
category$$ 
==$$ 
null$$  
)$$  !
throw%% 
new%% 
	Exception%% #
(%%# $
$str%%$ <
)%%< =
;%%= >
entity'' 
.'' 
CategorySlug'' 
=''  !
category''" *
;''* +
await,, 
repo,, 
.,, 
AddAsync,, 
(,,  
entity,,  &
),,& '
;,,' (
return.. 
mapper.. 
... 
Map.. 
<.. 
ResourceGetDTO.. ,
>.., -
(..- .
entity... 4
)..4 5
;..5 6
}// 	
public00 
async00 
Task00 
Delete00  
(00  !
Guid00! %
id00& (
)00( )
{11 	
if22 
(22 
id22 
==22 
Guid22 
.22 
Empty22  
)22  !
return22" (
;22( )
var44 
item44 
=44 
await44 
repo44 !
.44! "
GetByIdAsync44" .
(44. /
id44/ 1
)441 2
;442 3
if66 
(66 
item66 
==66 
null66 
)66 
return66 $
;66$ %
await;; 
repo;; 
.;; 
DeleteAsync;; "
(;;" #
item;;# '
);;' (
;;;( )
}<< 	
public>> 
async>> 
Task>> 
	DeleteAll>> #
(>># $
)>>$ %
{?? 	
awaitCC 
repoCC 
.CC 

ClearAsyncCC !
(CC! "
)CC" #
;CC# $
}EE 	
publicGG 
asyncGG 
TaskGG 
EditGG 
(GG 
ResourceEditDTOGG .
modelGG/ 4
)GG4 5
{HH 	
ifII 
(II 
modelII 
==II 
nullII 
)II 
returnII %
;II% &
awaitJJ 
repoJJ 
.JJ 
UpdateAsyncJJ "
(JJ" #
mapperJJ# )
.JJ) *
MapJJ* -
<JJ- .
ResourceJJ. 6
>JJ6 7
(JJ7 8
modelJJ8 =
)JJ= >
)JJ> ?
;JJ? @
}KK 	
publicMM 
asyncMM 
TaskMM 
<MM 
ResourceGetDTOMM (
?MM( )
>MM) *
GetMM+ .
(MM. /
GuidMM/ 3
idMM4 6
)MM6 7
{NN 	
ifOO 
(OO 
idOO 
==OO 
GuidOO 
.OO 
EmptyOO  
)OO  !
returnPP 
nullPP 
;PP 
varRR 
itemRR 
=RR 
awaitRR 
repoRR !
.RR! "
GetByIdAsyncRR" .
(RR. /
idRR/ 1
)RR1 2
;RR2 3
ifTT 
(TT 
itemTT 
==TT 
nullTT 
)TT 
returnUU 
nullUU 
;UU 
returnWW 
mapperWW 
.WW 
MapWW 
<WW 
ResourceGetDTOWW ,
>WW, -
(WW- .
itemWW. 2
)WW2 3
;WW3 4
}XX 	
publicZZ 
asyncZZ 
TaskZZ 
<ZZ 
IListZZ 
<ZZ  
ResourceGetDTOZZ  .
>ZZ. /
>ZZ/ 0
GetAllZZ1 7
(ZZ7 8
Guid[[ 
?[[ 
filterCategoryId[[ "
,[[" #
string\\ 
?\\ 
ByName\\ 
,\\ 
string]] 
?]] 
ByDescription]] !
,]]! "
decimal^^ 
?^^ 
	filterMin^^ 
,^^ 
decimal__ 
?__ 
	filterMax__ 
,__ 
bool`` 
?`` 
SortPriceAsc`` 
,`` 
intaa 

pageNumberaa 
=aa 
$numaa 
)aa 
{bb 	
ifcc 
(cc 

pageNumbercc 
<cc 
$numcc 
)cc 

pageNumberdd 
=dd 
$numdd 
;dd 
varff 
filterExff 
=ff 
PredicateBuilderff +
.ff+ ,
Newff, /
<ff/ 0
Resourceff0 8
>ff8 9
(ff9 :
trueff: >
)ff> ?
;ff? @
ifhh 
(hh 
filterCategoryIdhh  
!=hh! #
nullhh$ (
)hh( )
filterExii 
=ii 
filterExii #
.ii# $
Andii$ '
(ii' (
xii( )
=>ii* ,
xii- .
.ii. /

CategoryIdii/ 9
==ii: <
filterCategoryIdii= M
)iiM N
;iiN O
ifkk 
(kk 
!kk 
stringkk 
.kk 
IsNullOrWhiteSpacekk *
(kk* +
ByNamekk+ 1
)kk1 2
)kk2 3
filterExll 
=ll 
filterExll #
.ll# $
Andll$ '
(ll' (
xll( )
=>ll* ,
xll- .
.ll. /
Namell/ 3
.ll3 4
ToLowerll4 ;
(ll; <
)ll< =
.ll= >
Containsll> F
(llF G
ByNamellG M
.llM N
ToLowerllN U
(llU V
)llV W
)llW X
)llX Y
;llY Z
ifnn 
(nn 
!nn 
stringnn 
.nn 
IsNullOrWhiteSpacenn *
(nn* +
ByDescriptionnn+ 8
)nn8 9
)nn9 :
filterExoo 
=oo 
filterExoo #
.oo# $
Andoo$ '
(oo' (
xoo( )
=>oo* ,
xoo- .
.oo. /
Descriptionoo/ :
.oo: ;
ToLoweroo; B
(ooB C
)ooC D
.ooD E
ContainsooE M
(ooM N
ByDescriptionooN [
.oo[ \
ToLoweroo\ c
(ooc d
)ood e
)ooe f
)oof g
;oog h
ifqq 
(qq 
	filterMinqq 
!=qq 
nullqq !
)qq! "
filterExrr 
=rr 
filterExrr #
.rr# $
Andrr$ '
(rr' (
xrr( )
=>rr* ,
xrr- .
.rr. /
PricePerHourrr/ ;
>=rr< >
	filterMinrr? H
.rrH I
ValuerrI N
)rrN O
;rrO P
ifss 
(ss 
	filterMaxss 
!=ss 
nullss !
)ss! "
filterExtt 
=tt 
filterExtt #
.tt# $
Andtt$ '
(tt' (
xtt( )
=>tt* ,
xtt- .
.tt. /
PricePerHourtt/ ;
<=tt< >
	filterMaxtt? H
.ttH I
ValuettI N
)ttN O
;ttO P
varvv 
queryvv 
=vv 
repovv 
.vv 
GetAllAsyncvv (
(vv( )
	filteringvv) 2
:vv2 3
filterExvv4 <
,vv< =
includesvv> F
:vvF G
nameofvvH N
(vvN O
ResourcevvO W
.vvW X
CategoryvvX `
)vv` a
)vva b
;vvb c
varxx 
itemsxx 
=xx 
awaitxx 
queryxx #
;xx# $
if{{ 
({{ 
SortPriceAsc{{ 
!={{ 
null{{  $
){{$ %
{|| 
items}} 
=}} 
SortPriceAsc}} $
.}}$ %
Value}}% *
?~~ 
items~~ 
.~~ 
OrderBy~~ #
(~~# $
x~~$ %
=>~~& (
x~~) *
.~~* +
PricePerHour~~+ 7
)~~7 8
.~~8 9
ToList~~9 ?
(~~? @
)~~@ A
: 
items 
. 
OrderByDescending -
(- .
x. /
=>0 2
x3 4
.4 5
PricePerHour5 A
)A B
.B C
ToListC I
(I J
)J K
;K L
}
ÄÄ 
int
ÇÇ 
pageSize
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
items
ÉÉ 
=
ÉÉ 
items
ÉÉ 
.
ÉÉ 
Skip
ÉÉ 
(
ÉÉ 
(
ÉÉ  

pageNumber
ÉÉ  *
-
ÉÉ+ ,
$num
ÉÉ- .
)
ÉÉ. /
*
ÉÉ0 1
pageSize
ÉÉ2 :
)
ÉÉ: ;
.
ÑÑ 
Take
ÑÑ 
(
ÑÑ 
pageSize
ÑÑ '
)
ÑÑ' (
.
ÖÖ 
ToList
ÖÖ  
(
ÖÖ  !
)
ÖÖ! "
;
ÖÖ" #
return
áá 
mapper
áá 
.
áá 
Map
áá 
<
áá 
IList
áá #
<
áá# $
ResourceGetDTO
áá$ 2
>
áá2 3
>
áá3 4
(
áá4 5
items
áá5 :
)
áá: ;
;
áá; <
}
àà 	
public
ää 
async
ää 
Task
ää 
SeedResources
ää '
(
ää' (
)
ää( )
{
ãã 	
ctx
åå 
.
åå 
	Resources
åå 
.
åå 
RemoveRange
åå %
(
åå% &
ctx
åå& )
.
åå) *
	Resources
åå* 3
)
åå3 4
;
åå4 5
await
çç 
ctx
çç 
.
çç 
SaveChangesAsync
çç &
(
çç& '
)
çç' (
;
çç( )
var
èè 
	resources
èè 
=
èè 
new
èè 
List
èè  $
<
èè$ %
Resource
èè% -
>
èè- .
{
êê 
new
ëë 
Resource
ëë 
{
íí 	
Id
ìì 
=
ìì 
Guid
ìì 
.
ìì 
NewGuid
ìì 
(
ìì 
)
ìì 
,
ìì  
Name
îî 
=
îî 
$str
îî  
,
îî  !
Description
ïï 
=
ïï 
$str
ïï =
,
ïï= >
PricePerHour
ññ 
=
ññ 
$num
ññ 
,
ññ  
ImageUrl
óó 
=
óó 
$str
óó >
,
óó> ?
PriceByHour
òò 
=
òò 
$num
òò 
,
òò 
IsActive
ôô 
=
ôô 
true
ôô 
,
ôô 

CategoryId
öö 
=
öö 
Guid
öö 
.
öö 
Parse
öö #
(
öö# $
$str
öö$ J
)
ööJ K
,
ööK L
CategorySlug
õõ 
=
õõ 
CategorySlug
õõ '
.
õõ' (
Hotels
õõ( .
}
úú 	
,
úú	 

new
ùù 
Resource
ùù 
{
ûû 	
Id
üü 
=
üü 
Guid
üü 
.
üü 
NewGuid
üü 
(
üü 
)
üü 
,
üü  
Name
†† 
=
†† 
$str
†† (
,
††( )
Description
°° 
=
°° 
$str
°° B
,
°°B C
PricePerHour
¢¢ 
=
¢¢ 
$num
¢¢ 
,
¢¢  
ImageUrl
££ 
=
££ 
$str
££ >
,
££> ?
PriceByHour
§§ 
=
§§ 
$num
§§ 
,
§§ 
IsActive
•• 
=
•• 
true
•• 
,
•• 

CategoryId
¶¶ 
=
¶¶ 
Guid
¶¶ 
.
¶¶ 
Parse
¶¶ #
(
¶¶# $
$str
¶¶$ J
)
¶¶J K
,
¶¶K L
CategorySlug
ßß 
=
ßß 
CategorySlug
ßß '
.
ßß' (
Hotels
ßß( .
}
®® 	
,
®®	 

new
©© 
Resource
©© 
{
™™ 	
Id
´´ 
=
´´ 
Guid
´´ 
.
´´ 
NewGuid
´´ 
(
´´ 
)
´´ 
,
´´  
Name
¨¨ 
=
¨¨ 
$str
¨¨ 
,
¨¨  
Description
≠≠ 
=
≠≠ 
$str
≠≠ =
,
≠≠= >
PricePerHour
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
,
ÆÆ 
ImageUrl
ØØ 
=
ØØ 
$str
ØØ =
,
ØØ= >
PriceByHour
∞∞ 
=
∞∞ 
$num
∞∞ 
,
∞∞ 
IsActive
±± 
=
±± 
true
±± 
,
±± 

CategoryId
≤≤ 
=
≤≤ 
Guid
≤≤ 
.
≤≤ 
Parse
≤≤ #
(
≤≤# $
$str
≤≤$ J
)
≤≤J K
,
≤≤K L
CategorySlug
≥≥ 
=
≥≥ 
CategorySlug
≥≥ '
.
≥≥' (
Restaurants
≥≥( 3
}
¥¥ 	
,
¥¥	 

new
µµ 
Resource
µµ 
{
∂∂ 	
Id
∑∑ 
=
∑∑ 
Guid
∑∑ 
.
∑∑ 
NewGuid
∑∑ 
(
∑∑ 
)
∑∑ 
,
∑∑  
Name
∏∏ 
=
∏∏ 
$str
∏∏ #
,
∏∏# $
Description
ππ 
=
ππ 
$str
ππ 9
,
ππ9 :
PricePerHour
∫∫ 
=
∫∫ 
$num
∫∫ 
,
∫∫ 
ImageUrl
ªª 
=
ªª 
$str
ªª C
,
ªªC D
PriceByHour
ºº 
=
ºº 
$num
ºº 
,
ºº 
IsActive
ΩΩ 
=
ΩΩ 
true
ΩΩ 
,
ΩΩ 

CategoryId
ææ 
=
ææ 
Guid
ææ 
.
ææ 
Parse
ææ #
(
ææ# $
$str
ææ$ J
)
ææJ K
,
ææK L
CategorySlug
øø 
=
øø 
CategorySlug
øø '
.
øø' (
Restaurants
øø( 3
}
¿¿ 	
,
¿¿	 

new
¡¡ 
Resource
¡¡ 
{
¬¬ 	
Id
√√ 
=
√√ 
Guid
√√ 
.
√√ 
NewGuid
√√ 
(
√√ 
)
√√ 
,
√√  
Name
ƒƒ 
=
ƒƒ 
$str
ƒƒ #
,
ƒƒ# $
Description
≈≈ 
=
≈≈ 
$str
≈≈ A
,
≈≈A B
PricePerHour
∆∆ 
=
∆∆ 
$num
∆∆ 
,
∆∆ 
ImageUrl
«« 
=
«« 
$str
«« >
,
««> ?
PriceByHour
»» 
=
»» 
$num
»» 
,
»» 
IsActive
…… 
=
…… 
true
…… 
,
…… 

CategoryId
   
=
   
Guid
   
.
   
Parse
   #
(
  # $
$str
  $ J
)
  J K
,
  K L
CategorySlug
ÀÀ 
=
ÀÀ 
CategorySlug
ÀÀ '
.
ÀÀ' (
Sports
ÀÀ( .
}
ÃÃ 	
,
ÃÃ	 

new
ÕÕ 
Resource
ÕÕ 
{
ŒŒ 	
Id
œœ 
=
œœ 
Guid
œœ 
.
œœ 
NewGuid
œœ 
(
œœ 
)
œœ 
,
œœ  
Name
–– 
=
–– 
$str
–– &
,
––& '
Description
—— 
=
—— 
$str
—— J
,
——J K
PricePerHour
““ 
=
““ 
$num
““ 
,
““ 
ImageUrl
”” 
=
”” 
$str
”” ?
,
””? @
PriceByHour
‘‘ 
=
‘‘ 
$num
‘‘ 
,
‘‘ 
IsActive
’’ 
=
’’ 
true
’’ 
,
’’ 

CategoryId
÷÷ 
=
÷÷ 
Guid
÷÷ 
.
÷÷ 
Parse
÷÷ #
(
÷÷# $
$str
÷÷$ J
)
÷÷J K
,
÷÷K L
CategorySlug
◊◊ 
=
◊◊ 
CategorySlug
◊◊ '
.
◊◊' (
Sports
◊◊( .
}
ÿÿ 	
,
ÿÿ	 

new
ŸŸ 
Resource
ŸŸ 
{
⁄⁄ 	
Id
€€ 
=
€€ 
Guid
€€ 
.
€€ 
NewGuid
€€ 
(
€€ 
)
€€ 
,
€€  
Name
‹‹ 
=
‹‹ 
$str
‹‹ %
,
‹‹% &
Description
›› 
=
›› 
$str
›› G
,
››G H
PricePerHour
ﬁﬁ 
=
ﬁﬁ 
$num
ﬁﬁ 
,
ﬁﬁ 
ImageUrl
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ ?
,
ﬂﬂ? @
PriceByHour
‡‡ 
=
‡‡ 
$num
‡‡ 
,
‡‡ 
IsActive
·· 
=
·· 
true
·· 
,
·· 

CategoryId
‚‚ 
=
‚‚ 
Guid
‚‚ 
.
‚‚ 
Parse
‚‚ #
(
‚‚# $
$str
‚‚$ J
)
‚‚J K
,
‚‚K L
CategorySlug
„„ 
=
„„ 
CategorySlug
„„ '
.
„„' (
Beauty
„„( .
}
‰‰ 	
,
‰‰	 

new
ÂÂ 
Resource
ÂÂ 
{
ÊÊ 	
Id
ÁÁ 
=
ÁÁ 
Guid
ÁÁ 
.
ÁÁ 
NewGuid
ÁÁ 
(
ÁÁ 
)
ÁÁ 
,
ÁÁ  
Name
ËË 
=
ËË 
$str
ËË  
,
ËË  !
Description
ÈÈ 
=
ÈÈ 
$str
ÈÈ <
,
ÈÈ< =
PricePerHour
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
,
ÍÍ 
ImageUrl
ÎÎ 
=
ÎÎ 
$str
ÎÎ >
,
ÎÎ> ?
PriceByHour
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
,
ÏÏ 
IsActive
ÌÌ 
=
ÌÌ 
true
ÌÌ 
,
ÌÌ 

CategoryId
ÓÓ 
=
ÓÓ 
Guid
ÓÓ 
.
ÓÓ 
Parse
ÓÓ #
(
ÓÓ# $
$str
ÓÓ$ J
)
ÓÓJ K
,
ÓÓK L
CategorySlug
ÔÔ 
=
ÔÔ 
CategorySlug
ÔÔ '
.
ÔÔ' (
Beauty
ÔÔ( .
}
 	
,
	 

new
ÒÒ 
Resource
ÒÒ 
{
ÚÚ 	
Id
ÛÛ 
=
ÛÛ 
Guid
ÛÛ 
.
ÛÛ 
NewGuid
ÛÛ 
(
ÛÛ 
)
ÛÛ 
,
ÛÛ  
Name
ÙÙ 
=
ÙÙ 
$str
ÙÙ (
,
ÙÙ( )
Description
ıı 
=
ıı 
$str
ıı D
,
ııD E
PricePerHour
ˆˆ 
=
ˆˆ 
$num
ˆˆ 
,
ˆˆ 
ImageUrl
˜˜ 
=
˜˜ 
$str
˜˜ @
,
˜˜@ A
PriceByHour
¯¯ 
=
¯¯ 
$num
¯¯ 
,
¯¯ 
IsActive
˘˘ 
=
˘˘ 
true
˘˘ 
,
˘˘ 

CategoryId
˙˙ 
=
˙˙ 
Guid
˙˙ 
.
˙˙ 
Parse
˙˙ #
(
˙˙# $
$str
˙˙$ J
)
˙˙J K
,
˙˙K L
CategorySlug
˚˚ 
=
˚˚ 
CategorySlug
˚˚ '
.
˚˚' (
Medical
˚˚( /
}
¸¸ 	
,
¸¸	 

new
˝˝ 
Resource
˝˝ 
{
˛˛ 	
Id
ˇˇ 
=
ˇˇ 
Guid
ˇˇ 
.
ˇˇ 
NewGuid
ˇˇ 
(
ˇˇ 
)
ˇˇ 
,
ˇˇ  
Name
ÄÄ 
=
ÄÄ 
$str
ÄÄ 1
,
ÄÄ1 2
Description
ÅÅ 
=
ÅÅ 
$str
ÅÅ 7
,
ÅÅ7 8
PricePerHour
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
,
ÇÇ  
ImageUrl
ÉÉ 
=
ÉÉ 
$str
ÉÉ ?
,
ÉÉ? @
PriceByHour
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
,
ÑÑ 
IsActive
ÖÖ 
=
ÖÖ 
true
ÖÖ 
,
ÖÖ 

CategoryId
ÜÜ 
=
ÜÜ 
Guid
ÜÜ 
.
ÜÜ 
Parse
ÜÜ #
(
ÜÜ# $
$str
ÜÜ$ J
)
ÜÜJ K
,
ÜÜK L
CategorySlug
áá 
=
áá 
CategorySlug
áá '
.
áá' (
Medical
áá( /
}
àà 	
}
ää 
;
ää 
await
åå 
ctx
åå 
.
åå 
	Resources
åå 
.
åå  
AddRangeAsync
åå  -
(
åå- .
	resources
åå. 7
)
åå7 8
;
åå8 9
await
çç 
ctx
çç 
.
çç 
SaveChangesAsync
çç &
(
çç& '
)
çç' (
;
çç( )
}
éé 	
}
íí 
}ìì ¶0
XC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Services\JwtService.cs
	namespace 	
BusinessLogic
 
. 
Services  
{ 
public 

class 

JwtService 
: 
IJwtService )
{ 
private 
readonly 
IConfiguration '
configuration( 5
;5 6
private 
readonly 
UserManager $
<$ %
User% )
>) *
userManager+ 6
;6 7
private 
readonly 

JwtOptions #

jwtOptions$ .
;. /
private 
readonly !
RandomNumberGenerator .
rng/ 2
=3 4!
RandomNumberGenerator5 J
.J K
CreateK Q
(Q R
)R S
;S T
public 

JwtService 
( 
IConfiguration (
configuration) 6
,6 7
UserManager 
< 
User 
> 
userManager )
,) *

JwtOptions 

jwtOptions !
)! "
{ 	
this 
. 
configuration 
=  
configuration! .
;. /
this 
. 
userManager 
= 
userManager *
;* +
this 
. 

jwtOptions 
= 

jwtOptions (
;( )
} 	
public 
RefreshToken  
GenerateRefreshToken 0
(0 1
string1 7
	ipAddress8 A
)A B
{ 	
var   
randomBytes   
=   
new   !
byte  " &
[  & '
$num  ' )
]  ) *
;  * +
rng!! 
.!! 
GetBytes!! 
(!! 
randomBytes!! $
)!!$ %
;!!% &
return## 
new## 
RefreshToken## #
{$$ 
Token%% 
=%% 
Convert%% 
.%%  
ToBase64String%%  .
(%%. /
randomBytes%%/ :
)%%: ;
,%%; <
Expires&& 
=&& 
DateTime&& "
.&&" #
UtcNow&&# )
.&&) *
AddDays&&* 1
(&&1 2

jwtOptions&&2 <
.&&< =&
RefreshTokenExpirationDays&&= W
)&&W X
,&&X Y
CreatedByIp'' 
='' 
	ipAddress'' '
}(( 
;(( 
})) 	
public++ 
string++ 
GenerateToken++ #
(++# $
IEnumerable++$ /
<++/ 0
Claim++0 5
>++5 6
claims++7 =
)++= >
{,, 	
var-- 
securityKey-- 
=-- 
new-- ! 
SymmetricSecurityKey--" 6
(--6 7
Encoding--7 ?
.--? @
UTF8--@ D
.--D E
GetBytes--E M
(--M N

jwtOptions--N X
.--X Y
Key--Y \
)--\ ]
)--] ^
;--^ _
var.. 
credentials.. 
=.. 
new.. !
SigningCredentials.." 4
(..4 5
securityKey..5 @
,..@ A
SecurityAlgorithms..B T
...T U

HmacSha256..U _
).._ `
;..` a
var00 
token00 
=00 
new00 
JwtSecurityToken00 ,
(00, -
issuer11 
:11 

jwtOptions11 "
.11" #
Issuer11# )
,11) *
claims22 
:22 
claims22 
,22 
expires33 
:33 
DateTime33 !
.33! "
UtcNow33" (
.33( )

AddMinutes33) 3
(333 4

jwtOptions334 >
.33> ?(
AccessTokenExpirationMinutes33? [
)33[ \
,33\ ]
signingCredentials44 "
:44" #
credentials44$ /
)44/ 0
;440 1
return66 
new66 #
JwtSecurityTokenHandler66 .
(66. /
)66/ 0
.660 1

WriteToken661 ;
(66; <
token66< A
)66A B
;66B C
}77 	
public99 
IEnumerable99 
<99 
Claim99  
>99  !
	GetClaims99" +
(99+ ,
User99, 0
user991 5
)995 6
{:: 	
var;; 
claims;; 
=;; 
new;; 
List;; !
<;;! "
Claim;;" '
>;;' (
{<< 
new== 
(== 

ClaimTypes== 
.== 
NameIdentifier== -
,==- .
user==/ 3
.==3 4
Id==4 6
)==6 7
,==7 8
new>> 
(>> 

ClaimTypes>> 
.>> 
Email>> $
,>>$ %
user>>& *
.>>* +
Email>>+ 0
??>>1 3
string>>4 :
.>>: ;
Empty>>; @
)>>@ A
,>>A B
new?? 
(?? 

ClaimTypes?? 
.?? 
DateOfBirth?? *
,??* +
user??, 0
.??0 1
	Birthdate??1 :
???: ;
.??; <
ToString??< D
(??D E
)??E F
????G I
string??J P
.??P Q
Empty??Q V
)??V W
}@@ 
;@@ 
varBB 
rolesBB 
=BB 
userManagerBB #
.BB# $
GetRolesAsyncBB$ 1
(BB1 2
userBB2 6
)BB6 7
.BB7 8
ResultBB8 >
;BB> ?
claimsCC 
.CC 
AddRangeCC 
(CC 
rolesCC !
.CC! "
SelectCC" (
(CC( )
roleCC) -
=>CC. 0
newCC1 4
ClaimCC5 :
(CC: ;
ClaimsIdentityCC; I
.CCI J 
DefaultRoleClaimTypeCCJ ^
,CC^ _
roleCC` d
)CCd e
)CCe f
)CCf g
;CCg h
returnEE 
claimsEE 
;EE 
}FF 	
}GG 
}HH ËY
]C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Services\CategoryService.cs
	namespace		 	
BusinessLogic		
 
.		 
Services		  
{

 
public 

class 
CategoryService  
:! "
ICategoryService# 3
{ 
private 
readonly '
ReservationServiceDbContext 4
ctx5 8
;8 9
private 
readonly 
IMapper  
mapper! '
;' (
public 
CategoryService 
( '
ReservationServiceDbContext :
ctx; >
,> ?
IMapper@ G
mapperH N
)N O
{ 	
this 
. 
ctx 
= 
ctx 
; 
this 
. 
mapper 
= 
mapper  
;  !
} 	
public 
async 
Task 
< 
CategoryDTO %
>% &
Create' -
(- .
CategoryCreateDTO. ?
category@ H
)H I
{ 	
if 
( 
category 
== 
null  
)  !
return 
null 
; 
var 
entity 
= 
mapper 
.  
Map  #
<# $
Category$ ,
>, -
(- .
category. 6
)6 7
;7 8
await 
ctx 
. 

Categories  
.  !
AddAsync! )
() *
entity* 0
)0 1
;1 2
await 
ctx 
. 
SaveChangesAsync &
(& '
)' (
;( )
return 
mapper 
. 
Map 
< 
CategoryDTO )
>) *
(* +
entity+ 1
)1 2
;2 3
} 	
public 
async 
Task 
Delete  
(  !
Guid! %
id& (
)( )
{   	
if!! 
(!! 
id!! 
==!! 
Guid!! 
.!! 
Empty!!  
)!!  !
return"" 
;"" 
var$$ 
entity$$ 
=$$ 
ctx$$ 
.$$ 

Categories$$ '
.$$' (
Find$$( ,
($$, -
id$$- /
)$$/ 0
;$$0 1
if%% 
(%% 
entity%% 
==%% 
null%% 
)%% 
return&& 
;&& 
ctx(( 
.(( 

Categories(( 
.(( 
Remove(( !
(((! "
entity((" (
)((( )
;(() *
await)) 
ctx)) 
.)) 
SaveChangesAsync)) &
())& '
)))' (
;))( )
}** 	
public,, 
async,, 
Task,, 
	DeleteAll,, #
(,,# $
),,$ %
{-- 	
ctx.. 
... 

Categories.. 
... 
RemoveRange.. &
(..& '
ctx..' *
...* +

Categories..+ 5
)..5 6
;..6 7
await// 
ctx// 
.// 
SaveChangesAsync// &
(//& '
)//' (
;//( )
}00 	
public22 
async22 
Task22 
<22 
CategoryDTO22 %
>22% &
Edit22' +
(22+ ,
CategoryDTO22, 7
category228 @
)22@ A
{33 	
if44 
(44 
category44 
==44 
null44  
)44  !
return55 
null55 
;55 
var77 
entity77 
=77 
await77 
ctx77 "
.77" #

Categories77# -
.77- .
	FindAsync77. 7
(777 8
category778 @
.77@ A
Id77A C
)77C D
;77D E
if88 
(88 
entity88 
==88 
null88 
)88 
return99 
null99 
;99 
entity;; 
.;; 
Name;; 
=;; 
category;; "
.;;" #
Name;;# '
;;;' (
entity<< 
.<< 
Slug<< 
=<< 
category<< "
.<<" #
Slug<<# '
;<<' (
ctx>> 
.>> 

Categories>> 
.>> 
Update>> !
(>>! "
entity>>" (
)>>( )
;>>) *
await?? 
ctx?? 
.?? 
SaveChangesAsync?? &
(??& '
)??' (
;??( )
returnAA 
mapperAA 
.AA 
MapAA 
<AA 
CategoryDTOAA )
>AA) *
(AA* +
entityAA+ 1
)AA1 2
;AA2 3
}BB 	
publicCC 
asyncCC 
TaskCC 
<CC 
CategoryDTOCC %
?CC% &
>CC& '
GetCC( +
(CC+ ,
GuidCC, 0
idCC1 3
)CC3 4
{DD 	
ifEE 
(EE 
idEE 
==EE 
GuidEE 
.EE 
EmptyEE  
)EE  !
returnFF 
nullFF 
;FF 
varHH 
itemHH 
=HH 
awaitHH 
ctxHH  
.HH  !

CategoriesHH! +
.HH+ ,
	FindAsyncHH, 5
(HH5 6
idHH6 8
)HH8 9
;HH9 :
ifJJ 
(JJ 
itemJJ 
==JJ 
nullJJ 
)JJ 
returnKK 
nullKK 
;KK 
returnMM 
mapperMM 
.MM 
MapMM 
<MM 
CategoryDTOMM )
>MM) *
(MM* +
itemMM+ /
)MM/ 0
;MM0 1
}NN 	
publicPP 
asyncPP 
TaskPP 
<PP 
IListPP 
<PP  
CategoryDTOPP  +
>PP+ ,
>PP, -
GetAllPP. 4
(PP4 5
stringPP5 ;
?PP; <
ByNamePP= C
,PPC D
CategorySlugPPE Q
categorySlugPPR ^
,PP^ _
intPP` c

pageNumberPPd n
=PPo p
$numPPq r
)PPr s
{QQ 	
ifRR 
(RR 

pageNumberRR 
<RR 
$numRR 
)RR 

pageNumberSS 
=SS 
$numSS 
;SS 

IQueryableUU 
<UU 
CategoryUU 
>UU  
queryUU! &
=UU' (
ctxUU) ,
.UU, -

CategoriesUU- 7
;UU7 8
ifWW 
(WW 
!WW 
stringWW 
.WW 
IsNullOrEmptyWW %
(WW% &
ByNameWW& ,
)WW, -
)WW- .
queryXX 
=XX 
queryXX 
.XX 
WhereXX #
(XX# $
cXX$ %
=>XX& (
cXX) *
.XX* +
NameXX+ /
.XX/ 0
ToLowerXX0 7
(XX7 8
)XX8 9
.XX9 :
ContainsXX: B
(XXB C
ByNameXXC I
.XXI J
ToLowerXXJ Q
(XXQ R
)XXR S
)XXS T
)XXT U
;XXU V
ifZZ 
(ZZ 
categorySlugZZ 
!=ZZ 
$numZZ  !
)ZZ! "
query[[ 
=[[ 
query[[ 
.[[ 
Where[[ #
([[# $
c[[$ %
=>[[& (
c[[) *
.[[* +
Slug[[+ /
==[[0 2
categorySlug[[3 ?
)[[? @
;[[@ A
var]] 
items]] 
=]] 
await]] 
	PagedList]] '
<]]' (
Category]]( 0
>]]0 1
.]]1 2
CreateAsync]]2 =
(]]= >
query]]> C
,]]C D

pageNumber]]E O
,]]O P
$num]]Q R
)]]R S
;]]S T
return^^ 
mapper^^ 
.^^ 
Map^^ 
<^^ 
IList^^ #
<^^# $
CategoryDTO^^$ /
>^^/ 0
>^^0 1
(^^1 2
items^^2 7
)^^7 8
;^^8 9
}__ 	
publicaa 
asyncaa 
Taskaa 
SeedCategoriesaa (
(aa( )
)aa) *
{bb 	
varcc 

categoriescc 
=cc 
newcc  
Listcc! %
<cc% &
Categorycc& .
>cc. /
{dd 
newee 
Categoryee 
{ee 
Nameee #
=ee$ %
$stree& =
,ee= >
Slugee? C
=eeD E
CategorySlugeeF R
.eeR S
HotelseeS Y
}eeZ [
,ee[ \
newff 
Categoryff 
{ff 
Nameff #
=ff$ %
$strff& 9
,ff9 :
Slugff; ?
=ff@ A
CategorySlugffB N
.ffN O
RestaurantsffO Z
}ff[ \
,ff\ ]
newgg 
Categorygg 
{gg 
Namegg #
=gg$ %
$strgg& <
,gg< =
Sluggg> B
=ggC D
CategorySlugggE Q
.ggQ R
SportsggR X
}ggY Z
,ggZ [
newhh 
Categoryhh 
{hh 
Namehh #
=hh$ %
$strhh& 4
,hh4 5
Slughh6 :
=hh; <
CategorySlughh= I
.hhI J
BeautyhhJ P
}hhQ R
,hhR S
newii 
Categoryii 
{ii 
Nameii #
=ii$ %
$strii& 7
,ii7 8
Slugii9 =
=ii> ?
CategorySlugii@ L
.iiL M
MedicaliiM T
}iiU V
,iiV W
newjj 
Categoryjj 
{jj 
Namejj #
=jj$ %
$strjj& 6
,jj6 7
Slugjj8 <
=jj= >
CategorySlugjj? K
.jjK L

ConferencejjL V
}jjW X
,jjX Y
newkk 
Categorykk 
{kk 
Namekk #
=kk$ %
$strkk& 2
,kk2 3
Slugkk4 8
=kk9 :
CategorySlugkk; G
.kkG H
	CoworkingkkH Q
}kkR S
,kkS T
newll 
Categoryll 
{ll 
Namell #
=ll$ %
$strll& 3
,ll3 4
Slugll5 9
=ll: ;
CategorySlugll< H
.llH I
	CarRentalllI R
}llS T
,llT U
newmm 
Categorymm 
{mm 
Namemm #
=mm$ %
$strmm& 8
,mm8 9
Slugmm: >
=mm? @
CategorySlugmmA M
.mmM N
AutoServicemmN Y
}mmZ [
,mm[ \
newnn 
Categorynn 
{nn 
Namenn #
=nn$ %
$strnn& /
,nn/ 0
Slugnn1 5
=nn6 7
CategorySlugnn8 D
.nnD E
EntertainmentnnE R
}nnS T
}oo 
;oo 
awaitqq 
ctxqq 
.qq 

Categoriesqq  
.qq  !
AddRangeAsyncqq! .
(qq. /

categoriesqq/ 9
)qq9 :
;qq: ;
awaitrr 
ctxrr 
.rr 
SaveChangesAsyncrr &
(rr& '
)rr' (
;rr( )
}ss 	
}tt 
}uu é
]C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Interfaces\IUserServices.cs
	namespace 	
BusinessLogic
 
. 

Interfaces "
{ 
public 

	interface 
IUserServices "
{ 
public 
Task 
Register 
( 
UserRegisterModel .
model/ 4
)4 5
;5 6
public 
Task 
< 
LoginResponse !
>! "
Login# (
(( )
UserLoginModel) 7
model8 =
,= >
string? E
?E F
	ipAddressG P
)P Q
;Q R
public		 
Task		 
Logout		 
(		 
)		 
;		 
public

 
Task

 
<

 
List

 
<

 
UserGetModel

 %
>

% &
>

& '
GetAll

( .
(

. /
)

/ 0
;

0 1
public 
Task 
< 
string 
> 
ForgetPssword )
() *
string* 0
Email1 6
)6 7
;7 8
public 
Task 
ResetPassword !
(! "
string" (
email) .
,. /
string0 6
token7 <
,< =
string> D
newPasswordE P
)P Q
;Q R
public 
Task 
< 
LoginResponse !
>! "
Refresh# *
(* +
RefreshRequest+ 9
model: ?
,? @
stringA G
?G H
	ipAddressI R
)R S
;S T
public 
Task 
Delete 
( 
string !
id" $
)$ %
;% &
} 
} ô
aC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Interfaces\IResourcesService.cs
	namespace 	
BusinessLogic
 
. 

Interfaces "
{ 
public 

	interface 
IResourcesService &
{ 
Task 
SeedResources 
( 
) 
; 
Task 
< 
IList 
< 
ResourceGetDTO !
>! "
>" #
GetAll$ *
(* +
Guid+ /
?/ 0
filterCategoryId1 A
,A B
stringC I
?I J
ByNameK Q
,Q R
stringS Y
?Y Z
ByDescription[ h
,h i
decimalj q
?q r
	filterMins |
,| }
decimal	~ Ö
?
Ö Ü
	filterMax
á ê
,
ê ë
bool
ë ï
?
ï ñ
SortPriceAsc
ó £
,
£ §
int
• ®

pageNumber
© ≥
)
≥ ¥
;
¥ µ
Task		 
<		 
ResourceGetDTO		 
?		 
>		 
Get		 !
(		! "
Guid		" &
id		' )
)		) *
;		* +
Task

 
<

 
ResourceGetDTO

 
>

 
Create

 #
(

# $
ResourceCreateDTO

$ 5
model

6 ;
)

; <
;

< =
Task 
Edit 
( 
ResourceEditDTO !
model" '
)' (
;( )
Task 
Delete 
( 
Guid 
id 
) 
; 
Task 
	DeleteAll 
( 
) 
; 
} 
} ∞
[C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Interfaces\IJwtService.cs
	namespace 	
BusinessLogic
 
. 

Interfaces "
{ 
public 

	interface 
IJwtService  
{ 
IEnumerable		 
<		 
Claim		 
>		 
	GetClaims		 $
(		$ %
User		% )
user		* .
)		. /
;		/ 0
string

 
GenerateToken

 
(

 
IEnumerable

 (
<

( )
Claim

) .
>

. /
claims

0 6
)

6 7
;

7 8
RefreshToken  
GenerateRefreshToken )
() *
string* 0
	ipAddress1 :
): ;
;; <
} 
} ı
`C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Interfaces\ICategoryService.cs
	namespace 	
BusinessLogic
 
. 

Interfaces "
{ 
public 

	interface 
ICategoryService %
{ 
Task 
SeedCategories 
( 
) 
; 
Task		 
<		 
IList		 
<		 
CategoryDTO		 
>		 
>		  
GetAll		! '
(		' (
string		( .
?		. /
ByName		0 6
,		6 7
CategorySlug		8 D
categorySlug		E Q
,		Q R
int		S V

pageNumber		W a
)		a b
;		b c
Task

 
<

 
CategoryDTO

 
?

 
>

 
Get

 
(

 
Guid

 #
id

$ &
)

& '
;

' (
Task 
< 
CategoryDTO 
> 
Create  
(  !
CategoryCreateDTO! 2
model3 8
)8 9
;9 :
Task 
< 
CategoryDTO 
> 
Edit 
( 
CategoryDTO *
model+ 0
)0 1
;1 2
Task 
Delete 
( 
Guid 
id 
) 
; 
Task 
	DeleteAll 
( 
) 
; 
} 
} Ü
RC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\HttpException.cs
	namespace 	
BusinessLogic
 
{ 
[ 
Serializable 
] 
public 

class 
HttpException 
:  
	Exception! *
{ 
public 
HttpStatusCode 

StatusCode (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
=7 8
HttpStatusCode9 G
.G H
InternalServerErrorH [
;[ \
public		 
HttpException		 
(		 
)		 
{		  
}		! "
public

 
HttpException

 
(

 
string

 #
message

$ +
,

+ ,
HttpStatusCode

- ;
code

< @
)

@ A
:

B C
base

D H
(

H I
message

I P
)

P Q
{ 	
this 
. 

StatusCode 
= 
code "
;" #
} 	
public 
HttpException 
( 
string #
message$ +
,+ ,
HttpStatusCode- ;
code< @
,@ A
	ExceptionB K
innerL Q
)Q R
:S T
baseU Y
(Y Z
messageZ a
,a b
innerc h
)h i
{ 	
this 
. 

StatusCode 
= 
code "
;" #
} 	
	protected 
HttpException 
(  
System
 
. 
Runtime 
. 
Serialization &
.& '
SerializationInfo' 8
info9 =
,= >
System
 
. 
Runtime 
. 
Serialization &
.& '
StreamingContext' 7
context8 ?
)? @
:A B
baseC G
(G H
infoH L
,L M
contextN U
)U V
{W X
}Y Z
} 
} ¯
ZC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Helpers\PaginatedList.cs
	namespace 	
BusinessLogic
 
. 
Helpers 
{ 
public 

class 
	PagedList 
< 
T 
> 
: 
List  $
<$ %
T% &
>& '
{ 
private 
	PagedList 
( 
IEnumerable %
<% &
T& '
>' (
currentPage) 4
,4 5
int6 9
count: ?
,? @
intA D

pageNumberE O
,O P
intQ T
pageSizeU ]
)] ^
{ 	
CurrentPage		 
=		 

pageNumber		 $
;		$ %
PageSize

 
=

 
pageSize

 
;

  

TotalCount 
= 
count 
; 
AddRange 
( 
currentPage  
)  !
;! "
} 	
public 
int 
CurrentPage 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
PageSize 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 

TotalCount 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 

TotalPages 
=>  
(! "
int" %
)% &
Math& *
.* +
Ceiling+ 2
(2 3

TotalCount3 =
/> ?
(@ A
doubleA G
)G H
PageSizeH P
)P Q
;Q R
public 
bool  
IsPreviousPageExists (
=>) +
CurrentPage, 7
>8 9
$num: ;
;; <
public 
bool 
IsNextPageExists $
=>% '
CurrentPage( 3
<4 5

TotalPages6 @
;@ A
public 
static 
async 
Task  
<  !
	PagedList! *
<* +
T+ ,
>, -
>- .
CreateAsync/ :
(: ;

IQueryable; E
<E F
TF G
>G H
sourceI O
,O P
intQ T

pageNumberU _
,_ `
inta d
pageSizee m
)m n
{ 	
var 
count 
= 
await 
source $
.$ %

CountAsync% /
(/ 0
)0 1
;1 2
var 
items 
= 
await 
source $
.$ %
Skip% )
() *
(* +

pageNumber+ 5
-6 7
$num8 9
)9 :
*; <
pageSize= E
)E F
.F G
TakeG K
(K L
pageSizeL T
)T U
.U V
ToListAsyncV a
(a b
)b c
;c d
return 
new 
	PagedList  
<  !
T! "
>" #
(# $
items$ )
,) *
count+ 0
,0 1

pageNumber2 <
,< =
pageSize> F
)F G
;G H
} 	
} 
} –
aC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\UserRegisterModel.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
UserRegisterModel "
{ 
public 
string 
Login 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
? 
	Birthdate "
{# $
get% (
;( )
set* -
;- .
}/ 0
}		 
}

 É
^C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\UserLoginModel.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
UserLoginModel 
{ 
public 
string 
Login 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} Ò
\C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\UserGetModel.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
UserGetModel 
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Login 
{ 
set "
;" #
get$ '
;' (
}) *
public		 
string		 
FullName		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
string

 
Email

 
{

 
set

 "
;

" #
get

$ '
;

' (
}

) *
public 
DateTime 
DateTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
decimal 
Balance 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
passwordHash "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
ICollection 
< 
Reservation &
>& '
?' (
Reservations) 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
} 
} Ó
^C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\RefreshRequest.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
RefreshRequest 
{ 
public 
string 
RefreshToken "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} »
[C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\LogoutModel.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
LogoutModel 
{ 
} 
} ã
]C:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\Users\LoginResponse.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
Users "
{ 
public 

class 
LoginResponse 
{ 
public 
string 
AccessToken !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
RefreshToken "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
}		 §
dC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\ResourceDTO\ResourceGetDTO.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
ResourceDTO (
{ 
public 

class 
ResourceGetDTO 
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public		 
string		 
Description		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
decimal

 
PricePerHour

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 
string 
ImageUrl 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
CategorySlug 
CategorySlug (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
Guid 

CategoryId 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} Ä

eC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\ResourceDTO\ResourceEditDTO.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
ResourceDTO (
{ 
public 

class 
ResourceEditDTO  
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
decimal 
PricePerHour #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public		 
string		 
ImageUrl		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
Guid

 

CategoryId

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
} 
} 
gC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\ResourceDTO\ResourceCreateDTO.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
ResourceDTO (
{ 
public 

class 
ResourceCreateDTO "
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
decimal 
PricePerHour #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
ImageUrl 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
Guid		 

CategoryId		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
}

 
} …
TC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\JwtOptions.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
{ 
public 

class 

JwtOptions 
{ 
public 
string 
Key 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
LifetimeInMinutes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int (
AccessTokenExpirationMinutes /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public		 
int		 &
RefreshTokenExpirationDays		 -
{		. /
get		0 3
;		3 4
set		5 8
;		8 9
}		: ;
public 
string 
Issuer 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} °
dC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\CategoryDTO\CategoryGetDTO.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
CategoryDTO (
{ 
public 

class 
CategoryDTO 
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public		 
CategorySlug		 
Slug		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
}

 
} ñ
gC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\DTOs\CategoryDTO\CategoruCreateDTO.cs
	namespace 	
BusinessLogic
 
. 
DTOs 
. 
CategoryDTO (
{ 
public 

class 
CategoryCreateDTO "
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
CategorySlug 
Slug  
{! "
get# &
;& '
set( +
;+ ,
}- .
}		 
}

 ó
aC:\Users\111\Desktop\qqqq\APIWeb\ReservationService\BusinessLogic\Configurations\MapperProfile.cs
	namespace 	
BusinessLogic
 
. 
Configurations &
{ 
public		 

class		 
MapperProfile		 
:		  
Profile		! (
{

 
public 
MapperProfile 
( 
) 
{ 	
	CreateMap 
< 
Resource 
, 
ResourceGetDTO  .
>. /
(/ 0
)0 1
.1 2

ReverseMap2 <
(< =
)= >
;> ?
	CreateMap 
< 
ResourceCreateDTO '
,' (
Resource) 1
>1 2
(2 3
)3 4
;4 5
	CreateMap 
< 
ResourceEditDTO %
,% &
Resource' /
>/ 0
(0 1
)1 2
;2 3
	CreateMap 
< 
Category 
, 
CategoryDTO  +
>+ ,
(, -
)- .
.. /

ReverseMap/ 9
(9 :
): ;
;; <
	CreateMap 
< 
Category 
, 
CategoryCreateDTO  1
>1 2
(2 3
)3 4
.4 5

ReverseMap5 ?
(? @
)@ A
;A B
	CreateMap 
< 
UserRegisterModel '
,' (
User) -
>- .
(. /
)/ 0
. 
	ForMember 
( 
x 
=> 
x  !
.! "
UserName" *
,* +
opt, /
=>0 2
opt3 6
.6 7
MapFrom7 >
(> ?
model? D
=>E G
modelH M
.M N
LoginN S
)S T
)T U
. 
	ForMember 
( 
x 
=> 
x  !
.! "
PasswordHash" .
,. /
opt0 3
=>4 6
opt7 :
.: ;
Ignore; A
(A B
)B C
)C D
;D E
	CreateMap 
< 
User 
, 
UserGetModel (
>( )
() *
)* +
;+ ,
} 	
} 
} 